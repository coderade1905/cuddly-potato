<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@48,700,1,0" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="../Navstyle/navstyle.css">
    <link rel="stylesheet" href="/home/public/homestyle.css">
    <link rel="stylesheet" href="/school-home/public/school-home.css">
    <link rel="stylesheet" href="/lm/public/style.css">
    <link rel="stylesheet" href="/commoncss/public/modal.css">
    <script src="/jquery.min.js"></script>
    <script src="../Navstyle/nav.js"></script>
    <script src="/cookie-validate/validate.js"></script>
    <title>Learn</title>
</head>
<body>
    <noscript>Please enable javascript!!</noscript>
    <style>
        .main0 .header{
            margin-bottom: 0px;
        }
        .sel {
            height: 40px;
            background-color: transparent;
            color: #000;
        }
    </style>
    <script>
        var d = new Date();
        var year = d.getFullYear();
        validate("student");
        $(document).ready(
            function () {
                $("#snay").text(getCookie("SN") + " "+ year);
                $.ajax({
                    url: '/learn',
                    type: 'POST',
                    data: {q : "", t : ""},
                    dataType: 'JSON',
                    success: function(response) {
                        for(i = 0; i < response.data.length; i++)
                        {
                            let d = new Date(response.data[i].Date);
                            d = d.toDateString();
                            $("#cont").append(`
                            <div class="ccont">
                                <div class="ccontm" onClick="Open('${response.data[i].Link}', '${response.data[i].Type}')">
                                    <img src="/uploads/thumb/${response.data[i].Thumb}" width="100%" height="100%" >
                                    </div>
                                <div class="ccontf">
                                    <h4>${unescape(response.data[i].Title)}</h4>
                                    <p>Date: ${d}</p>
                                    <div style='display: flex; justify-content: space-between;'><p>Si Academy</p> <div><a href="/uploads/${response.data[i].Link}" download><span class="material-symbols-outlined">download</span></a><span onclick="Modal('${response.data[i].Title}','${response.data[i].Description}', '${d}', '${response.data[i].Type}')" class="material-symbols-outlined">info</span></div></div>
                                </div>
                            </div>`)
                        }
                    },
                    error: function(xhr, status, error) {
                        
                    }
                });
                $("#search").submit(
                    function (e) {
                        e.preventDefault();
                        $("#cont").empty();
                        $.ajax({
                            url: '/learn',
                            type: 'POST',
                            data: {q : $("#searchinp").val(), t : $("#type").find(":selected").val()},
                            dataType: 'JSON',
                            success: function(response) {
                                for(i = 0; i < response.data.length; i++)
                                {
                                    let d = new Date(response.data[i].Date);
                                    d = d.toDateString();
                                    $("#cont").append(`
                                    <div class="ccont">
                                        <div class="ccontm" onClick="Open('${response.data[i].Link}', '${response.data[i].Type}')">
                                            <img src="/uploads/thumb/${response.data[i].Thumb}" width="100%" height="100%" >
                                            </div>
                                        <div class="ccontf">
                                            <h4>${unescape(response.data[i].Title)}</h4>
                                            <p>Date: ${d}</p>
                                            <div style='display: flex; justify-content: space-between;'><p>Si Academy</p> <div><a href="/uploads/${response.data[i].Link}" download><span class="material-symbols-outlined">download</span></a><span onclick="Modal('${response.data[i].Title}','${response.data[i].Description}', '${d}', '${response.data[i].Type}')" class="material-symbols-outlined">info</span></div></div>
                                        </div>
                                    </div>`)
                                }
                            },
                            error: function(xhr, status, error) {
                                
                            }
                        });
                    }
                );
                $(".tbar").change(
                    function ()
                    {
                        $("#cont").empty();
                        $.ajax({
                            url: '/learn',
                            type: 'POST',
                            data: {q : $("#searchinp").val(), t : $("#type").find(":selected").val()},
                            dataType: 'JSON',
                            success: function(response) {
                                for(i = 0; i < response.data.length; i++)
                                {
                                    let d = new Date(response.data[i].Date);
                                    d = d.toDateString();
                                    $("#cont").append(`
                                    <div class="ccont">
                                        <div class="ccontm" onClick="Open('${response.data[i].Link}', '${response.data[i].Type}')">
                                            <img src="/uploads/thumb/${response.data[i].Thumb}" width="100%" height="100%" >
                                            </div>
                                        <div class="ccontf">
                                            <h4>${unescape(response.data[i].Title)}</h4>
                                            <p>Date: ${d}</p>
                                            <div style='display: flex; justify-content: space-between;'><p>Si Academy</p> <div><a href="/uploads/${response.data[i].Link}" download><span class="material-symbols-outlined">download</span></a><span onclick="Modal('${response.data[i].Title}','${response.data[i].Description}', '${d}', '${response.data[i].Type}')" class="material-symbols-outlined">info</span></div></div>
                                        </div>
                                    </div>`)
                                }
                            },
                            error: function(xhr, status, error) {
                                
                            }
                        });
                    }
                );
            }
        );
        validate("student");
    </script>
    <div class="fullnav" id="nav">
        <div class="navnav"><span class="close material-symbols-rounded" id="close">
            close
            </span></div>
        <div class="mmnu">
            <div class="wrap">
            <a href="">Payment</a><br>
            <a href="">Registeral Settings</a><br>
            <a href="">Lessons</a><br>
            <a href="">News & Annoucments</a><br>
            <a href="">Profile Settings</a><br>
            </div>
        </div>
    </div>
    <nav class="cnav">
        <img src="" alt="Chat Logo" class="logo">
        <span class="menu material-symbols-rounded" id="menu">
            menu
            </span>
    </nav>
    <div class="main">
        <div class="mainz1" id="mainz1"></div>
        <div class="main0" id="main0">
            <div class="header">
            <h1 id="snay"></h1>
            <h2 id="gbfs">Enjoy all the learning materials</h2>
            </div>
            <div class="upload-wrap">
                <div class="tbar">
                    <select class="sel" name="" id="">
                        <option value="" disabled selected hidden>Class</option>
                        <option value="">All Classes</option>
                    </select>
                </div>
                <div class="tbar">
                    <select class="sel" name="" id="type">
                        <option value="" disabled selected hidden>Type</option>
                        <option value="">All Types</option>
                        <option value="video">Video</option>
                        <option value=".pdf">Pdf</option>
                        <option value="pic">Pictures</option>
                        <option value=".docx">Word Documents</option>
                        <option value=".pptx">Powerpoint Presentations</option>
                        <option value="others">Others</option>
                    </select>
                </div>
                <div class="tbar">
                    <select class="sel" name="" id="">
                        <option value="" disabled selected hidden>From</option>
                        <option value="">All the world</option>
                        <option value="">My school only</option>
                        <option value="">My city only</option>
                        <option value="">My country only</option>
                    </select>
                </div>
    </div> 
    <form action="" id="search">
        <div class="search">
            <input autocomplete="off" type="text" placeholder="Search" id="searchinp" value="">
            <button type="submit">
                <span class="material-symbols-rounded">
                search
                </span>
            </button>
        </div>
    </form>
    <div class="cont" id="cont">

    </div>
        </div>
    </div>
    <div id="Modal" class="modal">
        <div class="modal-content" id="modal-content">
            <div class="modal-head">
            <span class="close1" onclick="$('#Modal').hide()">&times;</span>
            </div>
            <div class="modal-main">
            <p style="text-align: center; margin-top: 10%;" id="title">Title : </p>
            <p style="text-align: center;" id="desc">Description : </p>
            <p style="text-align: center;" id="date">Date : </p>
            <p style="text-align: center;" id="type1">Type : </p>
        </div>
            </div>
    </div>
        </div>
</body>
<script>
function Open(link, type){
    window.location = '/uploads/' + link
}
function Modal(title, desc, date, type)
{
    $("#Modal").css('display', 'block');
    $("#title").text("Title : " + unescape(title));
    $("#desc").text("Description : " + unescape(desc));
    $("#date").text("Date : " + date);
    $("#type1").text("Type : " + type);
}
</script>
</html>